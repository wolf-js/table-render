(()=>{"use strict";var t={6:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.expr2expr=e.xy2expr=e.expr2xy=e.indexAt=e.stringAt=void 0;var r="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function o(t){return r.charAt(t%r.length)}function i(t){for(var e=[];t>=0;)e.push(o(t)),t=parseInt(t/r.length+"",10)-1;return e.reverse().join("")}function n(t){for(var e=0,r=0;r<t.length;r++)e=26*e+t.charCodeAt(r)-64;return e-1}function s(t){for(var e="",r="",o=0;o<t.length;o+=1)t.charAt(o)>="0"&&t.charAt(o)<="9"?r+=t.charAt(o):e+=t.charAt(o).toUpperCase();return[n(e),parseInt(r,10)-1]}function h(t,e){return"".concat(i(t)).concat(e+1)}function a(t,e,r){var o=s(t);return h(o[0]+e,o[1]+r)}e.stringAt=i,e.indexAt=n,e.expr2xy=s,e.xy2expr=h,e.expr2expr=a,e.default={stringAt:i,indexAt:n,expr2xy:s,xy2expr:h,expr2expr:a}},423:function(t,e,r){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(r(745)),n=function(){function t(t,e,r,o,i){var n=this;this.range=t,this.x=e,this.y=r,this.rowHeight=o,this.colWidth=i,this.width=0,this.height=0,this.rowMap=new Map,this.colMap=new Map,t.eachRow((function(t){var e=o(t);e>0&&(n.rowMap.set(t,{y:n.height,height:e}),n.height+=e)})),t.eachCol((function(t){var e=i(t);e>0&&(n.colMap.set(t,{x:n.width,width:e}),n.width+=e)}))}return t.prototype.eachRow=function(t){var e=this;this.range.eachRow((function(r){var o=e.rowMap.get(r)||{y:0,height:0},i=o.y,n=o.height;n>0&&t(r,i,n)}))},t.prototype.eachCol=function(t){var e=this;this.range.eachCol((function(r){var o=e.colMap.get(r)||{x:0,width:0},i=o.x,n=o.width;n>0&&t(r,i,n)}))},t.prototype.each=function(t){var e=this;this.eachRow((function(r,o,i){e.eachCol((function(e,n,s){t(r,e,{x:n,y:o,width:s,height:i})}))}))},t.prototype.rect=function(t){var e,r,o=this,i=this,n=i.rowMap,s=i.colMap,h=i.range,a={x:0,y:0,width:0,height:0};return t.startRow>=h.startRow&&(a.y=(null===(e=n.get(t.startRow))||void 0===e?void 0:e.y)||0),t.eachRow((function(t){var e=o.rowHeight(t);e>0&&(t<h.startRow&&(a.y-=e),a.height+=e)})),t.startCol>=h.startCol&&(a.x=(null===(r=s.get(t.startCol))||void 0===r?void 0:r.x)||0),t.eachCol((function(t){var e=o.colWidth(t);e>0&&(t<h.startCol&&(a.x-=e),a.width+=e)})),a},t.create=function(e,r,o,n,s,h,a,c){return new t(new i.default(e,r,o,n),s,h,a,c)},t}();e.default=n},235:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this.target=t;var r=t.getContext("2d");if(!r)throw new Error("getContext(2d) is null");this._ctx=r,this._scale=e,this._target=t}return t.prototype.size=function(t,e){var r=this._target,o=this._scale;r.style.width="".concat(t,"px"),r.style.height="".concat(e,"px");var i=window.devicePixelRatio;return r.width=Math.floor(t*i),r.height=Math.floor(e*i),this._ctx.scale(i*o,i*o),this},t.prototype.attr=function(t,e){var r=this;return e?(this._ctx[t]=e,this):"string"==typeof t?this._ctx[t]:(Object.entries(t).forEach((function(t){var e=t[0],o=t[1];null!=o&&(r._ctx[e]=o)})),this)},t.prototype.measureTextWidth=function(t){return this.measureText(t).width},t.prototype.line=function(t,e,r,o,i){return i&&(this.attr({lineWidth:1,strokeStyle:i.color}),"medium"===i.type?this.attr({lineWidth:2}):"thick"===i.type?this.attr({lineWidth:3}):"dashed"===i.type?this.setLineDash([3,2]):"dotted"===i.type&&this.setLineDash([1,1])),this.moveTo(t,e).lineTo(r,o).stroke(),this},t.prototype.clearRect=function(t,e,r,o){return this._ctx.clearRect(t,e,r,o),this},t.prototype.fillRect=function(t,e,r,o){return this._ctx.fillRect(t,e,r,o),this},t.prototype.strokeRect=function(t,e,r,o){return this._ctx.strokeRect(t,e,r,o),this},t.prototype.fillText=function(t,e,r,o){return this._ctx.fillText(t,e,r,o),this},t.prototype.strokeText=function(t,e,r,o){return this._ctx.strokeText(t,e,r,o),this},t.prototype.measureText=function(t){return this._ctx.measureText(t)},t.prototype.getLineDash=function(){return this._ctx.getLineDash()},t.prototype.setLineDash=function(t){return this._ctx.setLineDash(t),this},t.prototype.createLinearGradient=function(t,e,r,o){return this._ctx.createLinearGradient(t,e,r,o)},t.prototype.createRadialGradient=function(t,e,r,o,i,n){return this._ctx.createRadialGradient(t,e,r,o,i,n)},t.prototype.createPattern=function(t,e){return this._ctx.createPattern(t,e)},t.prototype.beginPath=function(){return this._ctx.beginPath(),this},t.prototype.closePath=function(){return this._ctx.closePath(),this},t.prototype.moveTo=function(t,e){return this._ctx.moveTo(t,e),this},t.prototype.lineTo=function(t,e){return this._ctx.lineTo(t,e),this},t.prototype.bezierCurveTo=function(t,e,r,o,i,n){return this.bezierCurveTo(t,e,r,o,i,n),this},t.prototype.quadraticCurveTo=function(t,e,r,o){return this.quadraticCurveTo(t,e,r,o),this},t.prototype.arc=function(t,e,r,o,i,n){return this._ctx.arc(t,e,r,o,i,n),this},t.prototype.arcTo=function(t,e,r,o,i){return this._ctx.arcTo(t,e,r,o,i),this},t.prototype.ellipse=function(t,e,r,o,i,n,s,h){return this._ctx.ellipse(t,e,r,o,i,n,s,h),this},t.prototype.rect=function(t,e,r,o){return this._ctx.rect(t,e,r,o),this},t.prototype.fill=function(t){return this._ctx.fill(t),this},t.prototype.stroke=function(){return this._ctx.stroke(),this},t.prototype.clip=function(t){return this._ctx.clip(t),this},t.prototype.isPointInPath=function(t,e,r){return this._ctx.isPointInPath(t,e,r)},t.prototype.isPointInStroke=function(t,e){return this._ctx.isPointInStroke(t,e)},t.prototype.getTransform=function(){return this._ctx.getTransform()},t.prototype.rotate=function(t){return this._ctx.rotate(t),this},t.prototype.scale=function(t,e){return this._ctx.scale(t,e),this},t.prototype.translate=function(t,e){return this._ctx.translate(t,e),this},t.prototype.setTransform=function(t,e,r,o,i,n){return this._ctx.setTransform(t,e,r,o,i,n),this},t.prototype.drawImage=function(t,e,r){return this._ctx.drawImage(t,e,r),this},t.prototype.createImageData=function(t,e){return this._ctx.createImageData(t,e)},t.prototype.getImageData=function(t,e,r,o){return this._ctx.getImageData(t,e,r,o)},t.prototype.putImageData=function(t,e,r){return this._ctx.putImageData(t,e,r),this},t.prototype.save=function(){return this._ctx.save(),this},t.prototype.restore=function(){return this._ctx.restore(),this},t}();e.default=r},790:(t,e)=>{function r(t,e,r,o){if(t&&e){var i="";return r&&(i+="italic "),o&&(i+="bold "),"".concat(i," ").concat(e,"pt ").concat(t)}}Object.defineProperty(e,"__esModule",{value:!0}),e.cellRender=void 0,e.cellRender=function(t,e,o,i){var n=i.border,s=i.fontSize,h=i.fontName,a=i.bold,c=i.italic,l=i.color,u=i.bgcolor,f=i.align,p=i.valign,d=i.underline,y=i.strikethrough,_=i.rotate,w=i.textwrap,g=i.padding;if(t.save().beginPath().translate(o.x,o.y),n){var x=n.top,v=n.right,R=n.bottom,C=n.left;t.save(),x&&t.line(0,0,o.width,0,{type:x[0],color:x[1]}),v&&t.line(o.width,0,o.width,o.height,{type:v[0],color:v[1]}),R&&t.line(0,o.height,o.width,o.height,{type:R[0],color:R[1]}),C&&t.line(0,0,0,o.height,{type:C[0],color:C[1]}),t.restore()}t.attr("fillStyle",u).rect(.5,.5,o.width-1,o.height-1).clip().fill(),t.save().beginPath().attr({textAlign:f,textBaseline:p,font:r(h,s,c,a),fillStyle:l}),_&&_>0&&t.rotate(_*(Math.PI/180));var b=g||[5,5],m=b[0],S=b[1],P=function(t,e,r){switch(t){case"left":return r;case"center":return e/2;case"right":return e-r;default:return 0}}(f,o.width,m),O=e.split("\n"),T=o.width-2*m,j=[];O.forEach((function(e){var r=t.measureTextWidth(e);if(w&&r>T){for(var o={w:0,len:0,start:0},i=0;i<e.length;i+=1)o.w>T&&(j.push(e.substr(o.start,o.len)),o={w:0,len:0,start:i}),o.len+=1,o.w+=t.measureTextWidth(e[i])+1;o.len>0&&j.push(e.substr(o.start,o.len))}else j.push(e)}));var M=1.425*s,H=(j.length-1)*M,L=[];d&&L.push("underline"),y&&L.push("strikethrough");var k=function(t,e,r,o){switch(t){case"top":return o;case"middle":return e/2-r/2;case"bottom":return e-o-r;default:return 0}}(p,o.height,H,S);j.forEach((function(e){var r=t.measureTextWidth(e);t.fillText(e,P,k),L.forEach((function(e){t.line.apply(t,function(t,e,r,o,i,n,s){var h=0;"underline"===t?"top"===r?h=-s:"middle"===r&&(h=-s/2):"strikethrough"===t&&("top"===r?h=-s/2:"bottom"===r&&(h=s/2));var a=0;return"center"===e?a=n/2:"right"===e&&(a=n),[o-a,i-h,o-a+n,i-h]}(e,f,p,P,k,r,s))})),k+=M})),t.restore(),t.restore()},e.default={}},607:function(t,e,r){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.xy2expr=e.expr2xy=void 0;var i=r(6);Object.defineProperty(e,"expr2xy",{enumerable:!0,get:function(){return i.expr2xy}}),Object.defineProperty(e,"xy2expr",{enumerable:!0,get:function(){return i.xy2expr}});var n=r(393),s=o(r(281)),h=function(){function t(t,e,r){this._width=0,this._height=0,this._scale=window.devicePixelRatio||1,this._rows=100,this._cols=26,this._rowHeight=25,this._colWidth=100,this._startRow=0,this._startCol=0,this._scrollRows=0,this._scrollCols=0,this._row=function(){},this._col=function(){},this._cell=function(){return""},this._merges=[],this._lineStyle={width:1,color:"#e6e6e6"},this._cellStyle={bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!0,underline:!1,strikethrough:!1,color:"#0a0a0a",bold:!1,italic:!1,rotate:0,fontSize:9,fontName:"Source Sans Pro"},this._rowHeader={width:60,cols:1,cell:function(t,e){return t+1},get colWidth(){return this.width/this.cols}},this._colHeader={height:25,rows:1,cell:function(t,e){return(0,i.stringAt)(e)},get rowHeight(){return this.height/this.rows}},this._headerLineStyle={width:1,color:"#e6e6e6"},this._headerCellStyle={bgcolor:"#f4f5f8",align:"center",valign:"middle",textwrap:!0,underline:!1,strikethrough:!1,color:"#585757",bold:!1,italic:!1,rotate:0,fontSize:9,fontName:"Source Sans Pro"},this._freeze=[0,0],this._freezeLineStyle={width:2,color:"#d8d8d8"},this._viewport=null;var o="string"==typeof t?document.querySelector(t):t;if(!o)throw new Error("target error");this._target=o,this._width=e,this._height=r}return t.prototype.render=function(){return this._viewport=new s.default(this),(0,n.render)(this),this},t.prototype.width=function(t){return this._width=t,this},t.prototype.height=function(t){return this._height=t,this},t.prototype.scale=function(t){return this._scale=t,this},t.prototype.rows=function(t){return this._rows=t,this},t.prototype.cols=function(t){return this._cols=t,this},t.prototype.rowHeight=function(t){return this._rowHeight=t,this},t.prototype.colWidth=function(t){return this._colWidth=t,this},t.prototype.startRow=function(t){return this._startRow=t,this},t.prototype.startCol=function(t){return this._startCol=t,this},t.prototype.scrollRows=function(t){return this._scrollRows=t,this},t.prototype.scrollCols=function(t){return this._scrollCols=t,this},t.prototype.row=function(t){return this._row=t,this},t.prototype.col=function(t){return this._col=t,this},t.prototype.cell=function(t){return this._cell=t,this},t.prototype.merges=function(t){return t&&(this._merges=t),this},t.prototype.lineStyle=function(t){return Object.assign(this._lineStyle,t),this},t.prototype.cellStyle=function(t){return Object.assign(this._cellStyle,t),this},t.prototype.rowHeader=function(t){return t&&Object.assign(this._rowHeader,t),this},t.prototype.colHeader=function(t){return t&&Object.assign(this._colHeader,t),this},t.prototype.headerLineStyle=function(t){return Object.assign(this._headerLineStyle,t),this},t.prototype.headerCellStyle=function(t){return t&&Object.assign(this._headerCellStyle,t),this},t.prototype.freeze=function(t){return t&&(this._freeze=(0,i.expr2xy)(t)),this},t.prototype.freezeLineStyle=function(t){return Object.assign(this._freezeLineStyle,t),this},t.create=function(e,r,o){return new t(e,r,o)},t}();e.default=h},745:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.eachRanges=e.newRange=void 0;var o=r(6),i=function(){function t(t,e,r,o){this.startRow=t,this.startCol=e,this.endRow=r,this.endCol=o}return Object.defineProperty(t.prototype,"start",{get:function(){return[this.startRow,this.startCol]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return[this.endRow,this.endCol]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this.endRow-this.startRow},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cols",{get:function(){return this.endCol-this.startCol},enumerable:!1,configurable:!0}),t.prototype.containsRow=function(t){return this.startRow<=t&&t<=this.endRow},t.prototype.containsCol=function(t){return this.startCol<=t&&t<=this.endCol},t.prototype.contains=function(t,e){return this.containsRow(t)&&this.containsCol(e)},t.prototype.within=function(t){return this.startRow>=t.startRow&&this.startCol>=t.startCol&&this.endRow<=t.endRow&&this.endCol<=t.endCol},t.prototype.intersects=function(t){return this.startRow<=t.endRow&&this.startCol<=t.endCol&&t.startRow<=this.endRow&&t.startCol<=this.endCol},t.prototype.union=function(e){return new t(e.startRow<this.startRow?e.startRow:this.startRow,e.startCol<this.startCol?e.startCol:this.startCol,e.endRow>this.endRow?e.endRow:this.endRow,e.endCol>this.endCol?e.endCol:this.endCol)},t.prototype.eachRow=function(t){for(var e=this.startRow;e<=this.endRow;e+=1)t(e);return this},t.prototype.eachCol=function(t){for(var e=this.startCol;e<=this.endCol;e+=1)t(e);return this},t.prototype.each=function(t){var e=this;return this.eachRow((function(r){e.eachCol((function(e){return t(r,e)}))})),this},t.prototype.clone=function(){return new t(this.startRow,this.startCol,this.endRow,this.endCol)},t}();function n(t){var e=t.split(":"),r=(0,o.expr2xy)(e[0]),n=(0,o.expr2xy)(e[1]);return new i(r[1],r[0],n[1],n[0])}e.default=i,e.newRange=n,e.eachRanges=function(t,e){t&&t.length>0&&t.forEach((function(t){e(n(t))}))}},393:function(t,e,r){var o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},o.apply(this,arguments)},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.render=void 0;var n=i(r(423)),s=i(r(235)),h=r(790),a=r(745);function c(t,e,r){var o=e.width,i=e.color;o>0&&(t.save().beginPath().attr({lineWidth:o,strokeStyle:i}),r(),t.restore())}function l(t,e,r,i){var n="",s=i;e&&("string"==typeof e||"number"==typeof e?n="".concat(e):(n=e.value||e.text||"",e.style&&(s=o(o({},i),e.style)))),(0,h.cellRender)(t,n,r,s)}function u(t,e,r,i,n,s,h,u){if(e){t.save().translate(e.x,e.y),function(t,e,r){c(t,r,(function(){e.eachRow((function(r,o,i){t.line(0,o+i,e.width,o+i)})),e.eachCol((function(r,o,i){t.line(o+i,0,o+i,e.height)}))}))}(t,e,n),t.rect(0,0,e.width,e.height).clip();var f=function(t,e){var r,n,s=o({},i);return h&&Object.assign(s,null===(r=h(t))||void 0===r?void 0:r.style),u&&Object.assign(s,null===(n=u(e))||void 0===n?void 0:n.style),s};e.each((function(e,o,i){l(t,r(e,o),i,f(e,o))})),s&&(0,a.eachRanges)(s,(function(o){o.intersects(e.range)&&l(t,r(o.startRow,o.startCol),e.rect(o),f(o.startRow,o.startCol))})),t.restore()}}function f(t,e,r){u(t,e,r._cell,r._cellStyle,r._lineStyle,r._merges,r._row,r._col)}function p(t,e,r){var o=r._rowHeader,i=o.cell,n=o.width,s=o.merges;o.cols,n>0&&u(t,e,i,r._headerCellStyle,r._headerLineStyle,s)}function d(t,e,r){var o=r._colHeader,i=o.cell,n=o.height,s=o.merges;o.rows,n>0&&u(t,e,i,r._headerCellStyle,r._headerLineStyle,s)}e.render=function(t){var e=t._width,r=t._height,o=t._target,i=t._scale,h=t._viewport,a=t._freeze,l=t._rowHeader,y=t._colHeader;if(h){var _=new s.default(o,i);_.size(e,r);var w=h.areas,g=w[0],x=w[1],v=w[2],R=w[3],C=h.headerAreas,b=C[0],m=C[1],S=C[2],P=C[3];f(_,R,t),f(_,g,t),d(_,b,t),f(_,v,t),p(_,P,t),f(_,x,t),d(_,m,t),p(_,S,t);var O=a[0],T=a[1];(O>0||T>0)&&c(_,t._freezeLineStyle,(function(){O>0&&_.line(0,R.y,e,R.y),T>0&&_.line(R.x,0,R.x,r)}));var j=x.x,M=x.y;if(j>0&&M>0){var H=n.default.create(0,0,0,0,0,0,(function(){return y.height}),(function(){return l.width}));u(_,H,(function(){return""}),t._headerCellStyle,t._headerLineStyle)}}}},281:function(t,e,r){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=o(r(423));e.default=function(t){var e=[t._rowHeader.width,t._colHeader.height],r=e[0],o=e[1],n=t._freeze,s=n[0],h=n[1],a=function(e){var r=t._row(e);return(null==r?void 0:r.hide)?0:(null==r?void 0:r.height)||t._rowHeight};Object.assign({height:t._rowHeight});for(var c=function(e){var r=t._col(e);return(null==r?void 0:r.hide)?0:(null==r?void 0:r.width)||t._colWidth},l=t._startRow,u=t._startCol,f=t._rows,p=t._cols,d=i.default.create(l,u,h-1,s-1,r,o,a,c),y=[h+t._scrollRows,s+t._scrollCols],_=y[0],w=y[1],g=d.height,x=_;g<t._height&&x<f;)g+=a(x),x+=1;for(var v=d.width,R=w;v<t._width&&R<p;)v+=c(R),R+=1;var C=i.default.create(_,w,x-1,R-1,r+d.width,o+d.height,a,c),b=i.default.create(l,w,h-1,R-1,r+d.width,o,a,c),m=i.default.create(_,u,x-1,s-1,r,o+d.height,a,c);this.areas=[b,d,m,C];var S=t._rowHeader,P=t._colHeader,O=function(){return P.rowHeight},T=function(){return S.colWidth};this.headerAreas=[i.default.create(0,b.range.startCol,P.rows-1,b.range.endCol,C.x,0,O,c),i.default.create(0,d.range.startCol,P.rows-1,d.range.endCol,d.x,0,O,c),i.default.create(d.range.startRow,0,d.range.endRow,S.cols-1,0,d.y,a,T),i.default.create(m.range.startRow,0,m.range.endRow,S.cols-1,0,C.y,a,T)]}}},e={};!function r(o){var i=e[o];if(void 0!==i)return i.exports;var n=e[o]={exports:{}};return t[o].call(n.exports,n,n.exports,r),n.exports}(607)})();