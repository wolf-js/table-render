(()=>{"use strict";var t={6:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.expr2expr=e.xy2expr=e.expr2xy=e.indexAt=e.stringAt=void 0;const r="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function s(t){return r.charAt(t%r.length)}function i(t){const e=[];for(;t>=0;)e.push(s(t)),t=parseInt(t/r.length+"",10)-1;return e.reverse().join("")}function n(t){let e=0;for(let r=0;r<t.length;r++)e=26*e+t.charCodeAt(r)-64;return e-1}function h(t){let e="",r="";for(let s=0;s<t.length;s+=1)t.charAt(s)>="0"&&t.charAt(s)<="9"?r+=t.charAt(s):e+=t.charAt(s).toUpperCase();return[n(e),parseInt(r,10)-1]}function o(t,e){return`${i(t)}${e+1}`}function l(t,e,r){const[s,i]=h(t);return o(s+e,i+r)}e.stringAt=i,e.indexAt=n,e.expr2xy=h,e.xy2expr=o,e.expr2expr=l,e.default={stringAt:i,indexAt:n,expr2xy:h,xy2expr:o,expr2expr:l}},423:function(t,e,r){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=s(r(745));class n{constructor(t,e,r,s,i){this.range=t,this.x=e,this.y=r,this.rowHeight=s,this.colWidth=i,this.width=0,this.height=0,this.rowMap=new Map,this.colMap=new Map,t.eachRow((t=>{const e=s(t);e>0&&(this.rowMap.set(t,{y:this.height,height:e}),this.height+=e)})),t.eachCol((t=>{const e=i(t);e>0&&(this.colMap.set(t,{x:this.width,width:e}),this.width+=e)}))}eachRow(t){this.range.eachRow((e=>{const{y:r,height:s}=this.rowMap.get(e)||{y:0,height:0};s>0&&t(e,r,s)}))}eachCol(t){this.range.eachCol((e=>{const{x:r,width:s}=this.colMap.get(e)||{x:0,width:0};s>0&&t(e,r,s)}))}each(t){this.eachRow(((e,r,s)=>{this.eachCol(((i,n,h)=>{t(e,i,{x:n,y:r,width:h,height:s})}))}))}rect(t){var e,r;const{rowMap:s,colMap:i,range:n}=this,h={x:0,y:0,width:0,height:0};return t.startRow>=n.startRow&&(h.y=(null===(e=s.get(t.startRow))||void 0===e?void 0:e.y)||0),t.eachRow((t=>{const e=this.rowHeight(t);e>0&&(t<n.startRow&&(h.y-=e),h.height+=e)})),t.startCol>=n.startCol&&(h.x=(null===(r=i.get(t.startCol))||void 0===r?void 0:r.x)||0),t.eachCol((t=>{const e=this.colWidth(t);e>0&&(t<n.startCol&&(h.x-=e),h.width+=e)})),h}static create(t,e,r,s,h,o,l,a){return new n(new i.default(t,e,r,s),h,o,l,a)}}e.default=n},235:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e){this.target=t;const r=t.getContext("2d");if(!r)throw new Error("getContext(2d) is null");this._ctx=r,this._scale=e,this._target=t}size(t,e){const{_target:r,_scale:s}=this;r.style.width=`${t}px`,r.style.height=`${e}px`;const i=window.devicePixelRatio;return r.width=Math.floor(t*i),r.height=Math.floor(e*i),this._ctx.scale(i*s,i*s),this}attr(t,e){return e?(this._ctx[t]=e,this):"string"==typeof t?this._ctx[t]:(Object.entries(t).forEach((([t,e])=>{null!=e&&(this._ctx[t]=e)})),this)}measureTextWidth(t){return this.measureText(t).width}line(t,e,r,s,i){return i&&(this.attr({lineWidth:1,strokeStyle:i.color}),"medium"===i.type?this.attr({lineWidth:2}):"thick"===i.type?this.attr({lineWidth:3}):"dashed"===i.type?this.setLineDash([3,2]):"dotted"===i.type&&this.setLineDash([1,1])),this.moveTo(t,e).lineTo(r,s).stroke(),this}clearRect(t,e,r,s){return this._ctx.clearRect(t,e,r,s),this}fillRect(t,e,r,s){return this._ctx.fillRect(t,e,r,s),this}strokeRect(t,e,r,s){return this._ctx.strokeRect(t,e,r,s),this}fillText(t,e,r,s){return this._ctx.fillText(t,e,r,s),this}strokeText(t,e,r,s){return this._ctx.strokeText(t,e,r,s),this}measureText(t){return this._ctx.measureText(t)}getLineDash(){return this._ctx.getLineDash()}setLineDash(t){return this._ctx.setLineDash(t),this}createLinearGradient(t,e,r,s){return this._ctx.createLinearGradient(t,e,r,s)}createRadialGradient(t,e,r,s,i,n){return this._ctx.createRadialGradient(t,e,r,s,i,n)}createPattern(t,e){return this._ctx.createPattern(t,e)}beginPath(){return this._ctx.beginPath(),this}closePath(){return this._ctx.closePath(),this}moveTo(t,e){return this._ctx.moveTo(t,e),this}lineTo(t,e){return this._ctx.lineTo(t,e),this}bezierCurveTo(t,e,r,s,i,n){return this.bezierCurveTo(t,e,r,s,i,n),this}quadraticCurveTo(t,e,r,s){return this.quadraticCurveTo(t,e,r,s),this}arc(t,e,r,s,i,n){return this._ctx.arc(t,e,r,s,i,n),this}arcTo(t,e,r,s,i){return this._ctx.arcTo(t,e,r,s,i),this}ellipse(t,e,r,s,i,n,h,o){return this._ctx.ellipse(t,e,r,s,i,n,h,o),this}rect(t,e,r,s){return this._ctx.rect(t,e,r,s),this}fill(t){return this._ctx.fill(t),this}stroke(){return this._ctx.stroke(),this}clip(t){return this._ctx.clip(t),this}isPointInPath(t,e,r){return this._ctx.isPointInPath(t,e,r)}isPointInStroke(t,e){return this._ctx.isPointInStroke(t,e)}getTransform(){return this._ctx.getTransform()}rotate(t){return this._ctx.rotate(t),this}scale(t,e){return this._ctx.scale(t,e),this}translate(t,e){return this._ctx.translate(t,e),this}setTransform(t,e,r,s,i,n){return this._ctx.setTransform(t,e,r,s,i,n),this}drawImage(t,e,r){return this._ctx.drawImage(t,e,r),this}createImageData(t,e){return this._ctx.createImageData(t,e)}getImageData(t,e,r,s){return this._ctx.getImageData(t,e,r,s)}putImageData(t,e,r){return this._ctx.putImageData(t,e,r),this}save(){return this._ctx.save(),this}restore(){return this._ctx.restore(),this}}},790:(t,e)=>{function r(t,e,r,s){if(t&&e){let i="";return r&&(i+="italic "),s&&(i+="bold "),`${i} ${e}pt ${t}`}}Object.defineProperty(e,"__esModule",{value:!0}),e.cellRender=void 0,e.cellRender=function(t,e,s,i){const{border:n,fontSize:h,fontName:o,bold:l,italic:a,color:c,bgcolor:u,align:d,valign:_,underline:w,strikethrough:g,rotate:f,textwrap:x,padding:y}=i;if(t.save().beginPath().translate(s.x,s.y),n){const{top:e,right:r,bottom:i,left:h}=n;t.save(),e&&t.line(0,0,s.width,0,{type:e[0],color:e[1]}),r&&t.line(s.width,0,s.width,s.height,{type:r[0],color:r[1]}),i&&t.line(0,s.height,s.width,s.height,{type:i[0],color:i[1]}),h&&t.line(0,0,0,s.height,{type:h[0],color:h[1]}),t.restore()}t.attr("fillStyle",u).rect(.5,.5,s.width-1,s.height-1).clip().fill(),t.save().beginPath().attr({textAlign:d,textBaseline:_,font:r(o,h,a,l),fillStyle:c}),f&&f>0&&t.rotate(f*(Math.PI/180));const[p,R]=y||[5,5],C=function(t,e,r){switch(t){case"left":return r;case"center":return e/2;case"right":return e-r;default:return 0}}(d,s.width,p),v=e.split("\n"),b=s.width-2*p,m=[];v.forEach((e=>{const r=t.measureTextWidth(e);if(x&&r>b){let r={w:0,len:0,start:0};for(let s=0;s<e.length;s+=1)r.w>b&&(m.push(e.substr(r.start,r.len)),r={w:0,len:0,start:s}),r.len+=1,r.w+=t.measureTextWidth(e[s])+1;r.len>0&&m.push(e.substr(r.start,r.len))}else m.push(e)}));const S=1.425*h,P=(m.length-1)*S,T=[];w&&T.push("underline"),g&&T.push("strikethrough");let M=function(t,e,r,s){switch(t){case"top":return s;case"middle":return e/2-r/2;case"bottom":return e-s-r;default:return 0}}(_,s.height,P,R);m.forEach((e=>{const r=t.measureTextWidth(e);t.fillText(e,C,M),T.forEach((e=>{t.line(...function(t,e,r,s,i,n,h){let o=0;"underline"===t?"top"===r?o=-h:"middle"===r&&(o=-h/2):"strikethrough"===t&&("top"===r?o=-h/2:"bottom"===r&&(o=h/2));let l=0;return"center"===e?l=n/2:"right"===e&&(l=n),[s-l,i-o,s-l+n,i-o]}(e,d,_,C,M,r,h))})),M+=S})),t.restore(),t.restore()},e.default={}},607:function(t,e,r){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.xy2expr=e.expr2xy=e.createTableRender=void 0;const i=r(6);Object.defineProperty(e,"expr2xy",{enumerable:!0,get:function(){return i.expr2xy}}),Object.defineProperty(e,"xy2expr",{enumerable:!0,get:function(){return i.xy2expr}});const n=r(393),h=s(r(281));class o{constructor(t,e,r){this._width=0,this._height=0,this._scale=window.devicePixelRatio||1,this._rows=100,this._cols=26,this._rowHeight=25,this._colWidth=100,this._startRow=0,this._startCol=0,this._scrollRows=0,this._scrollCols=0,this._row=()=>{},this._col=()=>{},this._cell=()=>{},this._merges=[],this._styles=[],this._lineStyle={width:1,color:"#e6e6e6"},this._cellStyle={bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!0,underline:!1,strikethrough:!1,color:"#0a0a0a",bold:!1,italic:!1,rotate:0,fontSize:9,fontName:"Source Sans Pro"},this._rowHeader={width:60,cols:1,cell:(t,e)=>t+1,get colWidth(){return this.width/this.cols}},this._colHeader={height:25,rows:1,cell:(t,e)=>(0,i.stringAt)(e),get rowHeight(){return this.height/this.rows}},this._headerLineStyle={width:1,color:"#e6e6e6"},this._headerCellStyle={bgcolor:"#f4f5f8",align:"center",valign:"middle",textwrap:!0,underline:!1,strikethrough:!1,color:"#585757",bold:!1,italic:!1,rotate:0,fontSize:9,fontName:"Source Sans Pro"},this._freeze=[0,0],this._freezeLineStyle={width:2,color:"#d8d8d8"},this._viewport=null;const s="string"==typeof t?document.querySelector(t):t;if(!s)throw new Error("target error");this._target=s,this._width=e,this._height=r}render(){return this._viewport=new h.default(this),(0,n.render)(this),this}width(t){return this._width=t,this}height(t){return this._height=t,this}scale(t){return this._scale=t,this}rows(t){return this._rows=t,this}cols(t){return this._cols=t,this}rowHeight(t){return this._rowHeight=t,this}colWidth(t){return this._colWidth=t,this}startRow(t){return this._startRow=t,this}startCol(t){return this._startCol=t,this}scrollRows(t){return this._scrollRows=t,this}scrollCols(t){return this._scrollCols=t,this}row(t){return this._row=t,this}col(t){return this._col=t,this}cell(t){return this._cell=t,this}merges(t){return t&&(this._merges=t),this}styles(t){return t&&(this._styles=t),this}lineStyle(t){return Object.assign(this._lineStyle,t),this}cellStyle(t){return Object.assign(this._cellStyle,t),this}rowHeader(t){return t&&Object.assign(this._rowHeader,t),this}colHeader(t){return t&&Object.assign(this._colHeader,t),this}headerLineStyle(t){return Object.assign(this._headerLineStyle,t),this}headerCellStyle(t){return t&&Object.assign(this._headerCellStyle,t),this}freeze(t){return t&&(this._freeze=(0,i.expr2xy)(t)),this}freezeLineStyle(t){return Object.assign(this._freezeLineStyle,t),this}}e.default=o,e.createTableRender=function(t,e,r){return new o(t,e,r)}},745:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.eachRanges=e.newRange=void 0;const s=r(6);class i{constructor(t,e,r,s){this.startRow=t,this.startCol=e,this.endRow=r,this.endCol=s}get start(){return[this.startRow,this.startCol]}get end(){return[this.endRow,this.endCol]}get rows(){return this.endRow-this.startRow}get cols(){return this.endCol-this.startCol}containsRow(t){return this.startRow<=t&&t<=this.endRow}containsCol(t){return this.startCol<=t&&t<=this.endCol}contains(t,e){return this.containsRow(t)&&this.containsCol(e)}within(t){return this.startRow>=t.startRow&&this.startCol>=t.startCol&&this.endRow<=t.endRow&&this.endCol<=t.endCol}intersects(t){return this.startRow<=t.endRow&&this.startCol<=t.endCol&&t.startRow<=this.endRow&&t.startCol<=this.endCol}union(t){return new i(t.startRow<this.startRow?t.startRow:this.startRow,t.startCol<this.startCol?t.startCol:this.startCol,t.endRow>this.endRow?t.endRow:this.endRow,t.endCol>this.endCol?t.endCol:this.endCol)}eachRow(t){for(let e=this.startRow;e<=this.endRow;e+=1)t(e);return this}eachCol(t){for(let e=this.startCol;e<=this.endCol;e+=1)t(e);return this}each(t){return this.eachRow((e=>{this.eachCol((r=>t(e,r)))})),this}clone(){return new i(this.startRow,this.startCol,this.endRow,this.endCol)}}function n(t){const e=t.split(":"),r=(0,s.expr2xy)(e[0]),n=(0,s.expr2xy)(e[1]);return new i(r[1],r[0],n[1],n[0])}e.default=i,e.newRange=n,e.eachRanges=function(t,e){t&&t.length>0&&t.forEach((t=>{e(n(t))}))}},393:function(t,e,r){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.render=void 0;const i=s(r(423)),n=s(r(235)),h=r(790),o=r(745);function l(t,{width:e,color:r},s){e>0&&(t.save().beginPath().attr({lineWidth:e,strokeStyle:r}),s(),t.restore())}function a(t,e,r,s,i){let n="",o=s;e&&("string"==typeof e||"number"==typeof e?n=`${e}`:(n=(e.value||"")+"",e.style&&(o=Object.assign(Object.assign({},s),i[e.style])))),(0,h.cellRender)(t,n,r,o)}function c(t,e,r,s,i,n,h,c,u){if(!e)return;t.save().translate(e.x,e.y),function(t,e,r){l(t,r,(()=>{e.eachRow(((r,s,i)=>{t.line(0,s+i,e.width,s+i)})),e.eachCol(((r,s,i)=>{t.line(s+i,0,s+i,e.height)}))}))}(t,e,i),t.rect(0,0,e.width,e.height).clip();const d=(t,e)=>{const r=Object.assign({},s);if(c){const e=c(t);e&&e.style&&Object.assign(r,n[e.style])}if(u){const t=u(e);t&&t.style&&Object.assign(r,n[t.style])}return r};e.each(((e,s,i)=>{a(t,r(e,s),i,d(e,s),n)})),h&&(0,o.eachRanges)(h,(s=>{s.intersects(e.range)&&a(t,r(s.startRow,s.startCol),e.rect(s),d(s.startRow,s.startCol),n)})),t.restore()}function u(t,e,r){c(t,e,r._cell,r._cellStyle,r._lineStyle,r._styles,r._merges,r._row,r._col)}function d(t,e,r){const{cell:s,width:i,merges:n,cols:h}=r._rowHeader;i>0&&c(t,e,s,r._headerCellStyle,r._headerLineStyle,r._styles,n)}function _(t,e,r){const{cell:s,height:i,merges:n,rows:h}=r._colHeader;i>0&&c(t,e,s,r._headerCellStyle,r._headerLineStyle,r._styles,n)}e.render=function(t){const{_width:e,_height:r,_target:s,_scale:h,_viewport:o,_freeze:a,_rowHeader:w,_colHeader:g}=t;if(o){const f=new n.default(s,h);f.size(e,r);const[x,y,p,R]=o.areas,[C,v,b,m]=o.headerAreas;u(f,R,t),u(f,x,t),_(f,C,t),u(f,p,t),d(f,m,t),u(f,y,t),_(f,v,t),d(f,b,t);const[S,P]=a;(S>0||P>0)&&l(f,t._freezeLineStyle,(()=>{S>0&&f.line(0,R.y,e,R.y),P>0&&f.line(R.x,0,R.x,r)}));const{x:T,y:M}=y;if(T>0&&M>0){const e=i.default.create(0,0,0,0,0,0,(()=>g.height),(()=>w.width));c(f,e,(()=>""),t._headerCellStyle,t._headerLineStyle,t._styles)}}}},281:function(t,e,r){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=s(r(423));e.default=class{constructor(t){const[e,r]=[t._rowHeader.width,t._colHeader.height],[s,n]=t._freeze,h=e=>{const r=t._row(e);return(null==r?void 0:r.hide)?0:(null==r?void 0:r.height)||t._rowHeight};Object.assign({height:t._rowHeight});const o=e=>{const r=t._col(e);return(null==r?void 0:r.hide)?0:(null==r?void 0:r.width)||t._colWidth},{_startRow:l,_startCol:a,_rows:c,_cols:u}=t,d=i.default.create(l,a,n-1,s-1,e,r,h,o),[_,w]=[n+t._scrollRows,s+t._scrollCols];let g=d.height,f=_;for(;g<t._height&&f<c;)g+=h(f),f+=1;let x=d.width,y=w;for(;x<t._width&&y<u;)x+=o(y),y+=1;const p=i.default.create(_,w,f-1,y-1,e+d.width,r+d.height,h,o),R=i.default.create(l,w,n-1,y-1,e+d.width,r,h,o),C=i.default.create(_,a,f-1,s-1,e,r+d.height,h,o);this.areas=[R,d,C,p];const{_rowHeader:v,_colHeader:b}=t,m=()=>b.rowHeight,S=()=>v.colWidth;this.headerAreas=[i.default.create(0,R.range.startCol,b.rows-1,R.range.endCol,p.x,0,m,o),i.default.create(0,d.range.startCol,b.rows-1,d.range.endCol,d.x,0,m,o),i.default.create(d.range.startRow,0,d.range.endRow,v.cols-1,0,d.y,h,S),i.default.create(C.range.startRow,0,C.range.endRow,v.cols-1,0,p.y,h,S)]}}}},e={};!function r(s){var i=e[s];if(void 0!==i)return i.exports;var n=e[s]={exports:{}};return t[s].call(n.exports,n,n.exports,r),n.exports}(607)})();